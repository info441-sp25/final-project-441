<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>!Graduated</title>
  <link rel="stylesheet" href="stylesheets/index.css" />
  <link rel="stylesheet" href="stylesheets/courses.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="img/favicon.svg" type="image/svg+xml" />
  <script src="javascripts/index.js"></script>
</head>

<body onload="checkLoginStatus(); init()">
  <div id="app" class="app">
    <nav class="navbar">
      <a href="/" class="logo">!Graduated</a>
      <div class="navbar-right">
        <div class="nav-tabs" id="tabs">
          <button class="nav-btn" onclick="goHome()">Home</button>
          <button class="nav-btn" onclick="goSaved()">Saved</button>
          <button class="nav-btn" onclick="goProfile()">Profile</button>
        </div>
        <a href="/courses.html" id="course-btn" class="auth-btn">Courses</a>
        <a href="/signin" id="login-btn" class="auth-btn login-btn">Log In</a>
        <a href="/signout" id="logout-btn" class="auth-btn hidden">Log Out</a>
      </div>
    </nav>

    <div id="courses" style="padding: 40px 20px 40px;" class="page">
      <div class="container">
        <h2>All Courses</h2>
        <div id="courses-results" class="card-grid"></div>
        <!-- Review Section Starts Here -->
        <!-- <div id="reviewForm" class="review-form hidden">
          <textarea id="reviewText" placeholder="Write your review..." rows="4"></textarea>
          <button onclick="submitReview()">Submit</button>
        </div>

          <div class="review-list" id="review-list">
            <div class="review-item">
              <p class="review-text"></p>
              <p class="review-author"></p>
            </div>
          </div>
        </div> -->
        <!-- Review Section Ends Here -->

      </div>
    </div>

    <script>
      async function init() {
        console.log("in allcourses init");
        document.getElementById("courses-results").innerText = "Loading...";

        const courses = await fetch('api/v1/course');
        const coursesJson = await courses.json();
        console.log(coursesJson);
        console.log(coursesJson[0]);

        document.getElementById("courses-results").innerHTML = coursesJson.length
          ? (coursesJson.map(course =>
            `
              <div class="card" id="${course.courseId}" style="margin-bottom: 1rem;">
                <div style="display: flex; justify-content: space-between;">
                  <h3>${course.courseId}: ${course.courseTitle}</h3>
                </div>
                <p>College: ${course.courseCollege}</p>
                <p>Credits: ${course.credits}</p>
                <button onclick="selectCourse('${course.courseId}')"> View Course </button>
              </div>
            `
          )).join("")
          : `<p>No matching courses found</p>`;
      }

      async function selectCourse(id) {
        console.log("selectCourse");
        location.href = `/course_detail.html?course=${id}`;
      }

      // function submitReview(event) {
      //   event.preventDefault();
      //   const text = document.getElementById("review-text").value.trim();
      //   if (!text) return;

      //   const reviewHTML = `
      //     <div class="review-item">
      //       <p class="review-text">${text}</p>
      //       <p class="review-author">â€“ You</p>
      //     </div>
      //   `;
      //   document.getElementById("review-list").insertAdjacentHTML("afterbegin", reviewHTML);
      //   document.getElementById("review-text").value = "";
      // }
    </script>
  </div>
</body>
</html>