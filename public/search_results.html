<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>!Graduated</title>
  <link rel="stylesheet" href="stylesheets/style.css">
  <link rel="stylesheet" href="stylesheets/search_results.css">    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="img/favicon.svg" type="image/svg+xml">
  <script src="javascripts/index.js"></script>

</head>
<body onload="checkLoginStatus()">

  <div id="app" class="app">
    <nav class="navbar">
        <a href="/" class="logo">!Graduated</a>
        <div class="tabs hidden" id="tabs">
          <button class="tab" onclick="goHome()">Home</button>
          <button class="tab" onclick="goSaved()">Saved</button>
          <button class="tab" onclick="goCourses()">Courses</button>
          <button class="tab" onclick="goProfile()">Profile</button>
        </div>
        <a href="/signin" id="login-btn" class="btn-login">Log In</a>
        <a href="/signout" id="logout-btn" class="btn-login hidden">Log Out</a>
    </nav>

    <div class="page">
        <button onclick="history.back()"> Back to Search</button>
      <div class="container">
        <h2>Matching Courses</h2>
        <div id="courses-results" class="card-grid">This will show your search results.</div>
      </div>
    </div>

    <script>
      async function fetchJSON(route) {
        const res = await fetch(route);
        return await res.json();
      }

      async function init() {
        const params = new URLSearchParams(window.location.search);
        const course = params.get('course');
        const department = params.get('department');
        const quarter = params.get('quarter');

        const query = new URLSearchParams();
        if (course) query.append('name', course);
        if (department) query.append('department', department);
        if (quarter) query.append('quarter', quarter);

        const results = await fetchJSON(`/api/v1/courses?${query.toString()}`);

        const container = document.getElementById("courses-results");
        container.innerHTML = results.length === 0
          ? "<p>No courses found.</p>"
          : results.map(course => `
            <div class="card">
              <h3>${course.courseCode}: ${course.courseName}</h3>
              <p>${course.courseDescription}</p>
            </div>
          `).join('');
      }

      window.addEventListener("DOMContentLoaded", init);
    </script>

  </div>
</body>
</html>